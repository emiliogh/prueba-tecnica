<div class="container py-4">
	<div class="mb-3">
		<input type="text" [(ngModel)]="searchTerm" class="form-control" placeholder="Buscar por nombre..." />
	</div>
	<div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-4 gap-3">
		<h2 class="mb-0">Listado de empleados</h2>
		<a routerLink="/empleados/nuevo" class="btn btn-success align-self-md-end">Nuevo empleado</a>
	</div>
	<div *ngIf="loading" class="alert alert-info">Cargando empleados...</div>
	<div class="table-responsive shadow rounded bg-white">
		<table class="table table-striped table-hover align-middle mb-0" *ngIf="employees.length">
			<thead class="table-dark">
						<tr>
							<th>Nombre</th>
							<th>Correo</th>
							<th>Cargo</th>
							<th>Fecha de ingreso</th>
							<th>Familiares</th>
							<th class="text-end">Acciones</th>
						</tr>
					<th>Fecha de ingreso</th>
			</thead>
			<tbody>
								<ng-container *ngFor="let emp of filteredEmployees">
									<tr>
										<td>{{ emp.nombre }}</td>
										<td>{{ emp.correo }}</td>
										<td>{{ emp.cargo }}</td>
										<td>{{ emp.fecha_ingreso | date:'yyyy-MM-dd' }}</td>
										<td>
											<button class="btn btn-sm btn-info" data-bs-toggle="modal" [attr.data-bs-target]="'#familiaresModal' + emp.id" (click)="selectedEmpleadoId = emp.id">Ver familiares</button>
										</td>
										<td class="text-end">
											<a [routerLink]="['/empleados/editar', emp.id]" class="btn btn-sm btn-outline-primary me-2">Editar</a>
											<button class="btn btn-sm btn-outline-danger" (click)="deleteEmployee(emp.id!)">Eliminar</button>
										</td>
									</tr>
									<!-- Modal Bootstrap para familiares -->
									<div class="modal fade" [id]="'familiaresModal' + emp.id" tabindex="-1" aria-labelledby="familiaresModalLabel" aria-hidden="true">
										<div class="modal-dialog modal-lg">
											<div class="modal-content">
												<div class="modal-header">
													<h5 class="modal-title" id="familiaresModalLabel">Familiares de {{ emp.nombre }}</h5>
													<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
												</div>
												<div class="modal-body">
													<app-familiares-list [idEmpleado]="emp.id!"></app-familiares-list>
												</div>
											</div>
										</div>
									</div>
								</ng-container>
			</tbody>
		</table>
	</div>
	<div *ngIf="!employees.length && !loading" class="alert alert-warning mt-3">No hay empleados registrados.</div>
</div>
